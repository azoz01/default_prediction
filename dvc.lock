schema: '2.0'
stages:
  split_data:
    cmd: python pipelines/bin/split_data.py
    deps:
    - path: pipelines/bin/split_data.py
      md5: 147d98da589e277d5e079c30a47b0a1a
      size: 1936
    - path: resources/data/raw
      md5: d7b249e098f4dc55aae557e066c9563c.dir
      size: 85166965
      nfiles: 7
    - path: utils
      md5: 1a055da60c29f0ea270f85b68c553955.dir
      size: 13741
      nfiles: 8
    params:
      params.yaml:
        split_data.random_state: 42
        split_data.test_size: 0.15
        split_data.valid_size: 0.15
    outs:
    - path: resources/data/splitted
      md5: 66957dd1526592edabb9dff07ef2d723.dir
      size: 24240491
      nfiles: 6
  transform_numerical_columns:
    cmd: python preprocessing/bin/transform_numerical_columns.py
    deps:
    - path: preprocessing/bin/transform_numerical_columns.py
      md5: f1d887d6386e1180862c340d9cafab13
      size: 1129
    - path: preprocessing/lib/numerical/numerical_columns_preprocessing.py
      md5: b86f2de473d326f047b74ccdae19202e
      size: 3307
    - path: resources/data/clean
      md5: 4de35af4d9d2ea2c20d9ad83c05a222b.dir
      size: 18004782
      nfiles: 6
    - path: utils
      md5: 26605127661aa31fd678281a39ce0510.dir
      size: 34768
      nfiles: 13
    outs:
    - path: resources/data/transformed_numerical_columns
      md5: a558c012934b79e492f5eccb449c69d8.dir
      size: 20485654
      nfiles: 6
    - path: resources/preprocessing/serialized/numerical_columns_transformer.pkl
      md5: 13b7558695d365a60717341deb8ddb0d
      size: 4739
  balance_data:
    cmd: python pipelines/bin/balance_data.py
    deps:
    - path: pipelines/bin/balance_data.py
      md5: af7cb5ae1f0709e316eb084fa6c636d9
      size: 1509
    - path: pipelines/lib/data_balance
      md5: 57c8b054f5f1d47df6780a7cfafa123a.dir
      size: 1688
      nfiles: 4
    - path: resources/data/transformed_numerical_columns
      md5: a9c594c0a5d4ad42fbde512747ce9666.dir
      size: 27881995
      nfiles: 6
    - path: utils
      md5: 1a055da60c29f0ea270f85b68c553955.dir
      size: 13741
      nfiles: 8
    params:
      params.yaml:
        balance_data.method: oversample
    outs:
    - path: resources/data/balanced
      md5: f9be8659cbc182cae8b14194f50f06d3.dir
      size: 41424376
      nfiles: 6
  transform_categorical_columns:
    cmd: python preprocessing/bin/transform_categorical_columns.py
    deps:
    - path: preprocessing/bin/transform_categorical_columns.py
      md5: e3d9c7769bd8640ac3d3e9e79f33dcee
      size: 1513
    - path: preprocessing/lib/categorical
      md5: df11bbbe3ff6c387f71016590c68758c.dir
      size: 23431
      nfiles: 6
    - path: resources/data/balanced
      md5: 119dd853509549b2c401a52fe850323b.dir
      size: 27420746
      nfiles: 6
    - path: utils
      md5: 26605127661aa31fd678281a39ce0510.dir
      size: 34768
      nfiles: 13
    params:
      params.yaml:
        category_embedding:
          embedder_n_epochs: 5
          embedder_num_layers: 2
        transform_categorical_columns:
          method: one_hot
    outs:
    - path: resources/data/transformed_categorical_column
      md5: c2d5d7ff41d8743fbfc300fe743eb6ef.dir
      size: 21101506
      nfiles: 6
    - path: resources/preprocessing/serialized/categorical_columns_transformer.pkl
      md5: 90eb712c901b55dcb6de92a453296744
      size: 3050
  reduce_data:
    cmd: python pipelines/bin/reduce_data.py
    deps:
    - path: pipelines/bin/reduce_data.py
      md5: b9132d976f34ce9e4f06b585655598d2
      size: 1643
    - path: resources/data/categorical_transformed
      md5: add40e5bbb39e9643b75e1a8c21419d5.dir
      size: 30253882
      nfiles: 6
    - path: utils
      md5: 1a055da60c29f0ea270f85b68c553955.dir
      size: 13741
      nfiles: 8
    params:
      params.yaml:
        frufs:
          output_n_cols: 200
        reduce_data.method: rfe
        rfe:
          output_n_cols: 200
    outs:
    - path: resources/data/reduced
      md5: 2fe640fb0d3328d7943805f53de79590.dir
      size: 29314002
      nfiles: 6
    - path: resources/pipelines/serialized/data_reductor.pkl
      md5: 3bc91848d026825faf42bc864cb62fc4
      size: 99158
  train_model:
    cmd: python models/bin/train_model.py
    deps:
    - path: models/bin/train_model.py
      md5: d609aef4a94b6af4721ada20ee0cdbe6
      size: 3980
    - path: resources/models/studies/xgboost/xgboost-2022-10-20-22_10_35.db
      md5: caeddadf9b8b258a11a49ee66e1d8543
      size: 995328
    - path: utils
      md5: 1a055da60c29f0ea270f85b68c553955.dir
      size: 13741
      nfiles: 8
    params:
      params.yaml:
        train_model:
          study_input_path: resources/models/studies/xgboost/xgboost-2022-10-20-22_10_35.db
          model_name: xgboost
          model_difference_threshold: 0.02
          model_class: xgboost
          data_path: reduced
    outs:
    - path: resources/models/parameters/xgboost.json
      md5: f4af700615c2abb682f106c3b9b528f9
      size: 1093
    - path: resources/models/serialized/xgboost.pkl
      md5: 089c30fe47bac086670ca66052b3c438
      size: 150383
  calibrate_model:
    cmd: python models/bin/calibrate_model.py
    deps:
    - path: models/bin/calibrate_model.py
      md5: ee409a1c6e3b0c5a06781805e2d6c6b5
      size: 1152
    - path: resources/models/serialized/xgboost.pkl
      md5: 089c30fe47bac086670ca66052b3c438
      size: 150383
    - path: utils
      md5: 1a055da60c29f0ea270f85b68c553955.dir
      size: 13741
      nfiles: 8
    params:
      params.yaml:
        calibrate_model:
          model_input_path: resources/models/serialized/xgboost.pkl
          data_path: reduced
          model_output_path: resources/models/serialized/xgboost_calibrated.pkl
          calibration_method: isotonic
    outs:
    - path: resources/models/serialized/xgboost_calibrated.pkl
      md5: c05e0c2b72580d81f864ae8a65e90661
      size: 191103
  train_gaussian_nb:
    cmd: python models/custom_train/train_gaussian_nb.py
    deps:
    - path: models/custom_train/train_gaussian_nb.py
      md5: 1a36d2b8df8c5d431c31f4ce6bb6618e
      size: 1360
    - path: utils
      md5: 1a055da60c29f0ea270f85b68c553955.dir
      size: 13741
      nfiles: 8
    outs:
    - path: resources/models/serialized/gaussian_nb.pkl
      md5: d63f72c02e987f63d1ac185013ec8cff
      size: 11990
  train_lda:
    cmd: python models/custom_train/train_lda.py
    deps:
    - path: models/custom_train/train_lda.py
      md5: 94cd11bc12ab1790b849e9e077c69df5
      size: 1412
    - path: utils
      md5: 1a055da60c29f0ea270f85b68c553955.dir
      size: 13741
      nfiles: 8
    outs:
    - path: resources/models/serialized/lda.pkl
      md5: 4e0c99bedc1d3b77460d4953750fb542
      size: 13833
  train_neural_network:
    cmd: python models/custom_train/train_neural_network.py
    deps:
    - path: models/custom_train/train_neural_network.py
      md5: 4ab95308d6002a15879f5a7828e89b8c
      size: 1108
    - path: utils
      md5: 1a055da60c29f0ea270f85b68c553955.dir
      size: 13741
      nfiles: 8
    outs:
    - path: resources/models/serialized/neural_network.pkl
      md5: 359f07796ed18ac9fcf6b0716e993f08
      size: 5312168
  initial_preprocessing:
    cmd: python preprocessing/bin/initial_preprocessing.py
    deps:
    - path: preprocessing/bin/initial_preprocessing.py
      md5: 7d93dccaef62a5e2cf77d59ec33acb5c
      size: 1362
    - path: preprocessing/lib/cleaning/initial_preprocessing.py
      md5: 1415793fe82d93bd0de9c7cfbb78feb4
      size: 2804
    - path: resources/data/raw
      md5: e14a5e77aa1b021859b8c26884c4b52a.dir
      size: 441777230
      nfiles: 5
    - path: utils
      md5: 26605127661aa31fd678281a39ce0510.dir
      size: 34768
      nfiles: 13
    outs:
    - path: resources/data/initially_preprocessed/loan.parquet
      md5: 569acb2349298a061fef29a9802eb2b2
      size: 20556346
    - path: resources/preprocessing/serialized/initial_preprocessor.pkl
      md5: 70cc6aa774bb3886ac0f8fa2ef3c64cb
      size: 921
  split:
    cmd: python preprocessing/bin/split.py
    deps:
    - path: preprocessing/bin/split.py
      md5: 660aeeef35a4b253e63393d57b9c746a
      size: 1639
    - path: resources/data/initially_preprocessed
      md5: 0b63b1098911cfee1685409dfc4f9e68.dir
      size: 20556346
      nfiles: 1
    - path: utils
      md5: 26605127661aa31fd678281a39ce0510.dir
      size: 34768
      nfiles: 13
    params:
      params.yaml:
        split_data:
          random_state: 42
          test_size: 0.15
          valid_size: 0.15
    outs:
    - path: resources/data/splitted
      md5: 0771f6a9cc97612f3bb777a4f39d1e2e.dir
      size: 20747117
      nfiles: 6
  impute:
    cmd: python preprocessing/bin/impute.py
    deps:
    - path: preprocessing/bin/impute.py
      md5: c37c5da5fb139c6efb91ad4fc674bad9
      size: 1058
    - path: preprocessing/lib/cleaning/imputation.py
      md5: 3464aa87bffafb721a239601aa375bf8
      size: 6709
    - path: resources/data/splitted
      md5: 0771f6a9cc97612f3bb777a4f39d1e2e.dir
      size: 20747117
      nfiles: 6
    - path: utils
      md5: 26605127661aa31fd678281a39ce0510.dir
      size: 34768
      nfiles: 13
    outs:
    - path: resources/data/clean
      md5: 4de35af4d9d2ea2c20d9ad83c05a222b.dir
      size: 18004782
      nfiles: 6
    - path: resources/preprocessing/serialized/imputer.pkl
      md5: a2c9ad9deb5ed0bd75d0e9dbc92685e6
      size: 61279348
  balance:
    cmd: python preprocessing/bin/balance.py
    deps:
    - path: preprocessing/bin/balance.py
      md5: 3dad15be626bb5e122c89c9de02bb614
      size: 1059
    - path: preprocessing/lib/balance_data
      md5: af30dc62b346b676846883bba0763a6e.dir
      size: 1691
      nfiles: 4
    - path: resources/data/transformed_numerical_columns
      md5: a558c012934b79e492f5eccb449c69d8.dir
      size: 20485654
      nfiles: 6
    - path: utils
      md5: 26605127661aa31fd678281a39ce0510.dir
      size: 34768
      nfiles: 13
    params:
      params.yaml:
        balance_data:
          method: oversample
    outs:
    - path: resources/data/balanced
      md5: 119dd853509549b2c401a52fe850323b.dir
      size: 27420746
      nfiles: 6
  reduce:
    cmd: python preprocessing/bin/reduce.py
    deps:
    - path: preprocessing/bin/reduce.py
      md5: 69cf87f90c5e985d28f8e778ced31db8
      size: 1227
    - path: preprocessing/lib/feature_selection
      md5: 2e91f38e5d0ae332ec4ee9b735145480.dir
      size: 4532
      nfiles: 6
    - path: resources/data/transformed_categorical_column
      md5: c2d5d7ff41d8743fbfc300fe743eb6ef.dir
      size: 21101506
      nfiles: 6
    - path: utils
      md5: 26605127661aa31fd678281a39ce0510.dir
      size: 34768
      nfiles: 13
    params:
      params.yaml:
        frufs:
          output_n_cols: 70
        reduce_data.method: rfe
        rfe:
          output_n_cols: 70
    outs:
    - path: resources/data/reduced
      md5: 5b797bab98630684c1b38372a10bc6e9.dir
      size: 20716577
      nfiles: 6
    - path: resources/preprocessing/serialized/data_reductor.pkl
      md5: 7b117fbfb3f65b906360c9fa07887118
      size: 78112
